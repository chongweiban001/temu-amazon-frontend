{% extends 'layout.html' %}

{% block page_title %}高级智能选品 - 亚马逊-Temu跨境选品分析系统{% endblock %}

{% block content %}
<div class="row">
    <!-- 左侧筛选条件卡片 -->
    <div class="col-md-4 mb-4">
        <div class="card shadow-sm">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0"><i class="bi bi-funnel-fill me-2"></i>智能选品筛选器</h5>
            </div>
            <div class="card-body">
                <form id="selection-form" method="POST" action="{{ url_for('advanced_selection') }}">
                    <!-- 基本筛选条件 -->
                    <div class="mb-4">
                        <h6 class="border-bottom pb-2 mb-3">基本条件</h6>
                        
                        <div class="mb-3">
                            <label class="form-label">商品评分</label>
                            <div class="row align-items-center">
                                <div class="col-auto">
                                    <span>最低</span>
                                </div>
                                <div class="col">
                                    <input type="range" class="form-range" min="1" max="5" step="0.1" value="4.0" id="rating-slider" name="min_rating">
                                </div>
                                <div class="col-auto">
                                    <span id="rating-value">4.0</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">最高价格(USD)</label>
                            <div class="row align-items-center">
                                <div class="col">
                                    <input type="range" class="form-range" min="5" max="200" step="5" value="50" id="price-slider" name="max_price">
                                </div>
                                <div class="col-auto">
                                    <span id="price-value">$50</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">最低评论数</label>
                            <div class="row align-items-center">
                                <div class="col">
                                    <input type="range" class="form-range" min="0" max="1000" step="50" value="100" id="reviews-slider" name="min_reviews">
                                </div>
                                <div class="col-auto">
                                    <span id="reviews-value">100</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 高级筛选条件 -->
                    <div class="mb-4">
                        <h6 class="border-bottom pb-2 mb-3">高级条件</h6>
                        
                        <div class="mb-3">
                            <label class="form-label">商品类目</label>
                            <div class="category-selector">
                                {% for category in categories %}
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="{{ category.id }}" id="category-{{ category.id }}" name="categories" checked>
                                    <label class="form-check-label" for="category-{{ category.id }}">
                                        {{ category.name }}
                                    </label>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">FBA可用性</label>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="fba-only" name="fba_only">
                                <label class="form-check-label" for="fba-only">仅显示FBA商品</label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">商品重量(磅)</label>
                            <div class="row">
                                <div class="col-6">
                                    <div class="input-group">
                                        <span class="input-group-text">最低</span>
                                        <input type="number" class="form-control" value="0" min="0" step="0.1" name="min_weight">
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="input-group">
                                        <span class="input-group-text">最高</span>
                                        <input type="number" class="form-control" value="5" min="0" step="0.1" name="max_weight">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Temu专项条件 -->
                    <div class="mb-4">
                        <h6 class="border-bottom pb-2 mb-3">Temu平台策略</h6>
                        
                        <div class="mb-3">
                            <label class="form-label">最低目标利润率</label>
                            <div class="row align-items-center">
                                <div class="col">
                                    <input type="range" class="form-range" min="5" max="50" step="5" value="25" id="profit-slider" name="min_profit">
                                </div>
                                <div class="col-auto">
                                    <span id="profit-value">25%</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">排除高风险品类</label>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="exclude-risk" name="exclude_risk" checked>
                                <label class="form-check-label" for="exclude-risk">自动排除FDA/CE/儿童产品等高风险类目</label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">BSR排名要求</label>
                            <div class="input-group">
                                <span class="input-group-text">前</span>
                                <input type="number" class="form-control" value="10000" name="max_bsr">
                                <span class="input-group-text">名</span>
                            </div>
                            <div class="form-text">排名越靠前，销量越高</div>
                        </div>
                    </div>
                    
                    <div class="d-grid gap-2">
                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-search me-2"></i>开始智能选品
                        </button>
                        <button type="reset" class="btn btn-outline-secondary">
                            <i class="bi bi-arrow-counterclockwise me-2"></i>重置条件
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- 右侧说明与指南 -->
    <div class="col-md-8">
        <div class="card shadow-sm mb-4">
            <div class="card-header bg-light">
                <h5 class="mb-0"><i class="bi bi-info-circle me-2"></i>智能选品指南</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <h6 class="text-primary mb-3">最佳选品策略</h6>
                        <ul class="list-unstyled">
                            <li><i class="bi bi-check-circle-fill text-success me-2"></i>专注轻量型商品 (&lt; 2磅)</li>
                            <li><i class="bi bi-check-circle-fill text-success me-2"></i>选择评分4.0+的商品</li>
                            <li><i class="bi bi-check-circle-fill text-success me-2"></i>避免知识产权风险商品</li>
                            <li><i class="bi bi-check-circle-fill text-success me-2"></i>寻找持续增长类目</li>
                            <li><i class="bi bi-check-circle-fill text-success me-2"></i>优先选择高利润率产品</li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <h6 class="text-danger mb-3">常见选品误区</h6>
                        <ul class="list-unstyled">
                            <li><i class="bi bi-x-circle-fill text-danger me-2"></i>盲目追求低价格产品</li>
                            <li><i class="bi bi-x-circle-fill text-danger me-2"></i>忽视物流成本计算</li>
                            <li><i class="bi bi-x-circle-fill text-danger me-2"></i>不考虑季节性因素</li>
                            <li><i class="bi bi-x-circle-fill text-danger me-2"></i>忽略产品复杂度</li>
                            <li><i class="bi bi-x-circle-fill text-danger me-2"></i>选择过度竞争类目</li>
                        </ul>
                    </div>
                </div>
                <hr>
                <div class="row mt-3">
                    <div class="col-md-12">
                        <h6 class="text-primary mb-3">Temu平台热销类目趋势</h6>
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <div class="card bg-light">
                                    <div class="card-body py-2">
                                        <div class="d-flex align-items-center">
                                            <span class="badge bg-success rounded-circle p-2 me-2">1</span>
                                            <span>家居装饰</span>
                                            <span class="ms-auto text-success"><i class="bi bi-graph-up"></i> 32%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <div class="card bg-light">
                                    <div class="card-body py-2">
                                        <div class="d-flex align-items-center">
                                            <span class="badge bg-success rounded-circle p-2 me-2">2</span>
                                            <span>厨房小工具</span>
                                            <span class="ms-auto text-success"><i class="bi bi-graph-up"></i> 28%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <div class="card bg-light">
                                    <div class="card-body py-2">
                                        <div class="d-flex align-items-center">
                                            <span class="badge bg-success rounded-circle p-2 me-2">3</span>
                                            <span>美容工具</span>
                                            <span class="ms-auto text-success"><i class="bi bi-graph-up"></i> 25%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <div class="card bg-light">
                                    <div class="card-body py-2">
                                        <div class="d-flex align-items-center">
                                            <span class="badge bg-primary rounded-circle p-2 me-2">4</span>
                                            <span>手机配件</span>
                                            <span class="ms-auto text-primary"><i class="bi bi-graph-up"></i> 20%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <div class="card bg-light">
                                    <div class="card-body py-2">
                                        <div class="d-flex align-items-center">
                                            <span class="badge bg-primary rounded-circle p-2 me-2">5</span>
                                            <span>宠物用品</span>
                                            <span class="ms-auto text-primary"><i class="bi bi-graph-up"></i> 18%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <div class="card bg-light">
                                    <div class="card-body py-2">
                                        <div class="d-flex align-items-center">
                                            <span class="badge bg-primary rounded-circle p-2 me-2">6</span>
                                            <span>收纳整理</span>
                                            <span class="ms-auto text-primary"><i class="bi bi-graph-up"></i> 15%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 数据分析卡片 -->
        <div class="card shadow-sm">
            <div class="card-header bg-light">
                <h5 class="mb-0"><i class="bi bi-pie-chart me-2"></i>选品数据分析</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <canvas id="category-performance-chart" height="250"></canvas>
                    </div>
                    <div class="col-md-6">
                        <canvas id="pricing-profit-chart" height="250"></canvas>
                    </div>
                </div>
                <div class="alert alert-info mt-3">
                    <i class="bi bi-lightbulb-fill me-2"></i>
                    分析显示，价格区间在$15-$35的产品在Temu平台最具竞争力，利润率可达25%-40%。
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // 滑块更新显示值
    document.addEventListener('DOMContentLoaded', function() {
        const ratingSlider = document.getElementById('rating-slider');
        const ratingValue = document.getElementById('rating-value');
        ratingSlider.addEventListener('input', function() {
            ratingValue.textContent = this.value;
        });
        
        const priceSlider = document.getElementById('price-slider');
        const priceValue = document.getElementById('price-value');
        priceSlider.addEventListener('input', function() {
            priceValue.textContent = '$' + this.value;
        });
        
        const reviewsSlider = document.getElementById('reviews-slider');
        const reviewsValue = document.getElementById('reviews-value');
        reviewsSlider.addEventListener('input', function() {
            reviewsValue.textContent = this.value;
        });
        
        const profitSlider = document.getElementById('profit-slider');
        const profitValue = document.getElementById('profit-value');
        profitSlider.addEventListener('input', function() {
            profitValue.textContent = this.value + '%';
        });
        
        // 示例图表 - 类目表现
        const categoryCtx = document.getElementById('category-performance-chart').getContext('2d');
        const categoryChart = new Chart(categoryCtx, {
            type: 'radar',
            data: {
                labels: ['销量', '利润率', '竞争度', '增长率', '审核通过率'],
                datasets: [
                    {
                        label: '电子产品',
                        data: [80, 60, 85, 70, 75],
                        borderColor: 'rgba(54, 162, 235, 1)',
                        backgroundColor: 'rgba(54, 162, 235, 0.2)'
                    },
                    {
                        label: '家居用品',
                        data: [65, 75, 65, 85, 90],
                        borderColor: 'rgba(255, 99, 132, 1)',
                        backgroundColor: 'rgba(255, 99, 132, 0.2)'
                    },
                    {
                        label: '厨房用品',
                        data: [70, 80, 60, 75, 85],
                        borderColor: 'rgba(75, 192, 192, 1)',
                        backgroundColor: 'rgba(75, 192, 192, 0.2)'
                    }
                ]
            },
            options: {
                scales: {
                    r: {
                        beginAtZero: true,
                        max: 100
                    }
                }
            }
        });
        
        // 示例图表 - 价格与利润关系
        const pricingCtx = document.getElementById('pricing-profit-chart').getContext('2d');
        const pricingChart = new Chart(pricingCtx, {
            type: 'line',
            data: {
                labels: ['$5', '$10', '$15', '$20', '$25', '$30', '$35', '$40', '$45', '$50'],
                datasets: [
                    {
                        label: '平均利润率',
                        data: [15, 18, 25, 30, 35, 40, 37, 32, 28, 25],
                        borderColor: 'rgba(153, 102, 255, 1)',
                        backgroundColor: 'rgba(153, 102, 255, 0.2)',
                        fill: true,
                        tension: 0.3
                    },
                    {
                        label: '销量指数',
                        data: [90, 85, 75, 65, 55, 45, 40, 30, 25, 20],
                        borderColor: 'rgba(255, 159, 64, 1)',
                        backgroundColor: 'rgba(255, 159, 64, 0.2)',
                        fill: false,
                        borderDash: [5, 5]
                    }
                ]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 100
                    }
                }
            }
        });
    });
</script>
{% endblock %} 